(()=>{"use strict";const t=new class{generate(t){if(!1===t||null==t)return document.createTextNode("");if("string"!=typeof t.type)return document.createTextNode("");const e=document.createElement(`${t.type}`);return t.attr&&Object.entries(t.attr).forEach((([t,s])=>{"class"===t?e.className=s.join(" "):e.setAttribute(t,s)})),t.listener&&(Array.isArray(t.listener)?t.listener.forEach((t=>e.addEventListener(t.type,t.cb))):e.addEventListener(t.listener.type,t.listener.cb)),"string"==typeof t.content?(""===t.content&&(e.textContent=""),e.textContent=t.content):Array.isArray(t.content)?t.content.forEach((t=>e.appendChild(this.generate(t)))):"object"==typeof t.content&&e.appendChild(this.generate(t.content)),e}},e=[];(async()=>{const t=await fetch("https://api.unsplash.com/photos?client_id=R90ZpgVQc2yOCzzDh9E1yELEPKUIxkXe9W8rXCHp4NE&page=1&per_page=30");return(await t.json()).map((t=>t.urls.regular))})().then((t=>e.push(...t)));class s{constructor({id:t,oldPrice:e,price:s,title:i,seen:n,locality:r,date:l}){this.id=t,this.oldPrice=e,this.price=s,this.title=i,this.seen=n,this.locality=r,this.date=l}render(){const s=new Date(this.date),i=`${s.toLocaleDateString()} ${s.toLocaleTimeString().slice(0,5)}`;return t.generate({type:"article",attr:{class:["bulletin"],"data-id":this.id},content:[{type:"div",attr:{class:["slider",""+(this.seen?"seen":"")]},content:[{type:"div",attr:{class:["slider__items"]},listener:[{type:"mouseenter",cb:()=>this.onMouseEnter()},{type:"mouseleave",cb:()=>this.onMouseLeave()}],content:[{type:"div",attr:{class:["slider__item","slider__item-active"]},content:{type:"img",attr:{class:["slider__image"],src:e[Math.floor(Math.random()*e.length)]||"https://source.unsplash.com/random",alt:"bulletin_picture"},content:""}},{type:"div",attr:{class:["slider__item"]},content:{type:"img",attr:{class:["slider__image"],src:e[Math.floor(Math.random()*e.length)]||"https://source.unsplash.com/random",alt:"bulletin_picture"},content:""}},{type:"div",attr:{class:["slider__item"]},content:{type:"img",attr:{class:["slider__image"],src:e[Math.floor(Math.random()*e.length)]||"https://source.unsplash.com/random",alt:"bulletin_picture"},content:""}},{type:"div",attr:{class:["slider__item"]},content:{type:"img",attr:{class:["slider__image"],src:e[Math.floor(Math.random()*e.length)]||"https://source.unsplash.com/random",alt:"bulletin_picture"},content:""}}]},{type:"div",attr:{class:["slider__navigation"]},content:{type:"div",attr:{class:["slider__dots"]},content:[{type:"div",attr:{class:["slider__dot","slider__dot-active"]},listener:{type:"click",cb:t=>this.onClickDot(t)},content:""},{type:"div",attr:{class:["slider__dot"]},listener:{type:"click",cb:t=>this.onClickDot(t)},content:""},{type:"div",attr:{class:["slider__dot"]},listener:{type:"click",cb:t=>this.onClickDot(t)},content:""},{type:"div",attr:{class:["slider__dot"]},listener:{type:"click",cb:t=>this.onClickDot(t)},content:""}]}}]},{type:"div",attr:{class:["bulletin__body",""+(this.seen?"seen":"")]},content:[{type:"div",attr:{class:["bulletin__oldPrice"]},content:`${this.oldPrice} ₽`},{type:"div",attr:{class:["bulletin__price"]},content:`${this.price} ₽`},{type:"div",attr:{class:["bulletin__title"]},content:this.title},{type:"div",attr:{class:["bulletin__wrapper"]},content:[{type:"div",attr:{class:["bulletin__locality"]},content:this.locality.slice(0,15)},{type:"div",attr:{class:["bulletin__date"]},content:i}]}]},{type:"div",attr:{class:["bulletin__service"]},content:[{type:"div",attr:{class:["bulletin__compare"]},listener:[{type:"mouseenter",cb:t=>this.onCompareHandler(t)},{type:"mouseleave",cb:t=>this.onCompareHandler(t)}],content:""},{type:"div",attr:{class:["bulletin__like",""+(this.seen?"bulletin__like-success":"")]},listener:{type:"click",cb:t=>this.onClickLike(t)},content:""},{type:"div",attr:{class:["bulletin__delivery",""+(this.seen?"bulletin__delivery-success":"")]},listener:[{type:"mouseenter",cb:t=>this.onDeliveryHandler(t)},{type:"mouseleave",cb:t=>this.onDeliveryHandler(t)}],content:""},{type:"div",attr:{class:["bulletin__deal",""+(this.seen?"bulletin__deal-success":"")]},listener:[{type:"mouseenter",cb:t=>this.onDealHandler(t)},{type:"mouseleave",cb:t=>this.onDealHandler(t)}],content:""}]},{type:"div",attr:{class:["bulletin__seen",""+(this.seen?"":"hidden")]},content:"Просмотрено"}]})}onCompareHandler(t){t.target.classList.toggle("bulletin__compare-success")}onClickLike(t){t.target.classList.toggle("bulletin__like-success")}onDeliveryHandler(t){t.target.classList.toggle("bulletin__delivery-success")}onDealHandler(t){t.target.classList.toggle("bulletin__deal-success")}get bulletinContainer(){return document.querySelector(`.bulletin[data-id="${this.id}"]`)}get arraySliderItems(){return[...this.bulletinContainer.querySelectorAll(".slider__item")]}get arrayDotItems(){return[...this.bulletinContainer.querySelectorAll(".slider__dot")]}onClickDot(t){const e=this.arrayDotItems.findIndex((e=>e===t.target));this.changeSlide(e)}changeSlide(t){this.arraySliderItems.forEach((t=>t.classList.remove("slider__item-active"))),this.arraySliderItems[t].classList.add("slider__item-active"),this.arrayDotItems.forEach((t=>t.classList.remove("slider__dot-active"))),this.arrayDotItems[t].classList.add("slider__dot-active")}onMouseEnter(){let t=1;this.timerID=setInterval((()=>{t>3&&(t=0),this.changeSlide(t),t+=1}),2e3)}onMouseLeave(){clearInterval(this.timerID),this.timerID=null}}const i=document.getElementById("root");new class{constructor(t){if(!(t instanceof HTMLElement))throw new Error("This is not HTML element!");this.container=t,this.currentBulletin=0,this.step=16,this.state=[]}init(){this.bindToDOM(),this.registerEvents(),this.initState()}bindToDOM(){this.container.appendChild(t.generate(this.markup()))}registerEvents(){this.container.querySelector(".board__link-show-more").addEventListener("click",(()=>this.onShowMoreHandler()))}onShowMoreHandler(){this.renderBulletin()}async initState(){this.state=await(async()=>(await fetch("https://6075786f0baf7c0017fa64ce.mockapi.io/products")).json())(),await this.renderBulletin(this.step)}async renderBulletin(){for(let t=this.currentBulletin;t<this.currentBulletin+this.step;t++){if(100===t)return void(this.currentBulletin=100);const e=new s(this.state[t]);this.boardContentElement.appendChild(e.render())}this.currentBulletin+=this.step}get boardContentElement(){return this.container.querySelector(".board__content")}markup(){return{type:"section",attr:{class:["board"]},content:[{type:"div",attr:{class:["board__header"]},content:"Похожие объявления"},{type:"div",attr:{class:["board__content"]},content:""},{type:"div",attr:{class:["board__footer"]},content:{type:"a",attr:{class:["board__link-show-more"]},content:"Показать еще"}}]}}}(i).init()})();